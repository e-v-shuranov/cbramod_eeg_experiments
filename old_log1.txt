/home/eshuranov/miniconda3/bin/conda run -n cbramod --no-capture-output python /media/public/eshuranov/cbramod/finetune_main.py --epochs 100 --batch_size 64 --dropout 0.1 --optimizer AdamW --lr 1e-8 --weight_decay 5e-2 --datasets_dir /media/public/Datasets/cbramod_data/TURV_refine/processed --model_dir /media/public/eshuranov/cbramod/models_weights/tuev_23_model --downstream_dataset TUEV --num_of_classes 6
Namespace(seed=3407, cuda=1, epochs=100, batch_size=64, lr=1e-08, weight_decay=0.05, optimizer='AdamW', clip_value=1, dropout=0.1, classifier='all_patch_reps', downstream_dataset='TUEV', datasets_dir='/media/public/Datasets/cbramod_data/TURV_refine/processed', num_of_classes=6, model_dir='/media/public/eshuranov/cbramod/models_weights/tuev_23_model', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='pretrained_weights/pretrained_weights.pth', infer_only=False, model_for_test='path to model', n_chanels=16)
The downstream dataset is TUEV
68445 15487 29421
113353
/media/public/eshuranov/cbramod/models/model_for_tuev.py:18: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.backbone.load_state_dict(torch.load(param.foundation_dir, map_location=map_location))
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=16000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=200, out_features=6, bias=True)
  )
)
100%|███████████████████████████████████████| 1070/1070 [01:24<00:00, 12.61it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.07it/s]
Epoch 1 : Training Loss: 1.73976, acc: 0.16667, kappa: 0.00000, f1: 0.84179, LR: 0.00000, Time elapsed 1.50 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0     0    86]
 [    0     0     0     0     0   500]
 [    0     0     0     0     0 13822]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.34it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 48.50it/s]
Epoch 2 : Training Loss: 1.65863, acc: 0.16667, kappa: 0.00000, f1: 0.84179, LR: 0.00000, Time elapsed 1.53 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0     0    86]
 [    0     0     0     0     0   500]
 [    0     0     0     0     0 13822]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.27it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 53.25it/s]
Epoch 3 : Training Loss: 1.57328, acc: 0.16667, kappa: 0.00000, f1: 0.84179, LR: 0.00000, Time elapsed 1.53 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0     0    86]
 [    0     0     0     0     0   500]
 [    0     0     0     0     0 13822]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.38it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.65it/s]
Epoch 4 : Training Loss: 1.47847, acc: 0.16667, kappa: 0.00000, f1: 0.84179, LR: 0.00000, Time elapsed 1.52 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0     0    86]
 [    0     0     0     0     0   500]
 [    0     0     0     0     0 13822]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.25it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 53.56it/s]
Epoch 5 : Training Loss: 1.39004, acc: 0.16667, kappa: 0.00000, f1: 0.84179, LR: 0.00000, Time elapsed 1.53 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0     0    86]
 [    0     0     0     0     0   500]
 [    0     0     0     0     0 13822]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.36it/s]
100%|█████████████████████████████████████████| 242/242 [00:05<00:00, 47.12it/s]
Epoch 6 : Training Loss: 1.33610, acc: 0.16667, kappa: 0.00000, f1: 0.84179, LR: 0.00000, Time elapsed 1.53 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0     0    86]
 [    0     0     0     0     0   500]
 [    0     0     0     0     0 13822]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.24it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 53.36it/s]
Epoch 7 : Training Loss: 1.31242, acc: 0.16667, kappa: 0.00000, f1: 0.84179, LR: 0.00000, Time elapsed 1.53 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0     0    86]
 [    0     0     0     0     0   500]
 [    0     0     0     0     0 13822]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.28it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.35it/s]
Epoch 8 : Training Loss: 1.29880, acc: 0.16667, kappa: 0.00000, f1: 0.84179, LR: 0.00000, Time elapsed 1.53 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0     0    86]
 [    0     0     0     0     0   500]
 [    0     0     0     0     0 13822]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.20it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.34it/s]
Epoch 9 : Training Loss: 1.28726, acc: 0.16667, kappa: 0.00000, f1: 0.84179, LR: 0.00000, Time elapsed 1.54 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0     0    86]
 [    0     0     0     0     0   500]
 [    0     0     0     0     0 13822]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.22it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.14it/s]
Epoch 10 : Training Loss: 1.27267, acc: 0.17867, kappa: 0.04143, f1: 0.84724, LR: 0.00000, Time elapsed 1.54 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0     4    82]
 [    0     0     0     0    36   464]
 [    0     0     0     0     0 13822]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.17867, kappa: 0.04143, f1: 0.84724
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.22it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.87it/s]
Epoch 11 : Training Loss: 1.25384, acc: 0.19120, kappa: 0.08452, f1: 0.84991, LR: 0.00000, Time elapsed 1.54 mins
[[    0     0     0     0     0   119]
 [    0     0     0     0     0   291]
 [    0     0     0     0     0   669]
 [    0     0     0     0    24    62]
 [    0     0     0     0    76   424]
 [    0     0     0     0    66 13756]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.19120, kappa: 0.08452, f1: 0.84991
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.16it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.49it/s]
Epoch 12 : Training Loss: 1.22820, acc: 0.22236, kappa: 0.25323, f1: 0.84632, LR: 0.00000, Time elapsed 1.55 mins
[[    0    28     0     0    19    72]
 [    0     0     0     0   211    80]
 [    0     0     0     0   240   429]
 [    0     4     0     0    71    11]
 [    0     0     0     0   194   306]
 [    0    66     0     0   678 13078]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22236, kappa: 0.25323, f1: 0.84632
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.19it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.99it/s]
Epoch 13 : Training Loss: 1.19794, acc: 0.25291, kappa: 0.30210, f1: 0.84366, LR: 0.00000, Time elapsed 1.54 mins
[[    0     7     0     0    47    65]
 [    0    12     0     0   262    17]
 [    0     0     0     0   444   225]
 [    0     0     0     0    85     1]
 [    0     0     0     0   281   219]
 [    0    66     0     0  1120 12636]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25291, kappa: 0.30210, f1: 0.84366
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.23it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.03it/s]
Epoch 14 : Training Loss: 1.16533, acc: 0.26699, kappa: 0.30690, f1: 0.83932, LR: 0.00000, Time elapsed 1.54 mins
[[    0    20     0     0    47    52]
 [    0    12     0     0   279     0]
 [    0     0     0     0   454   215]
 [    0     0     0     0    86     0]
 [    0     0     0     0   331   169]
 [    0    28     0     0  1372 12422]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26699, kappa: 0.30690, f1: 0.83932
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.24it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.01it/s]
Epoch 15 : Training Loss: 1.13274, acc: 0.26706, kappa: 0.30444, f1: 0.83667, LR: 0.00000, Time elapsed 1.54 mins
[[    0    44     0     0    47    28]
 [    0    12     0     0   279     0]
 [    0     5     0     0   467   197]
 [    0     0     0     0    86     0]
 [    0     0     0     0   335   165]
 [    0   106     0     0  1399 12317]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.24it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.68it/s]
Epoch 16 : Training Loss: 1.09904, acc: 0.26710, kappa: 0.31138, f1: 0.83899, LR: 0.00000, Time elapsed 1.54 mins
[[    0    61     0     0    35    23]
 [    0    12     0     0   279     0]
 [    0    23     0     0   467   179]
 [    0     9     0     0    77     0]
 [    0     0     0     0   334   166]
 [    0   438     0     0  1036 12348]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26710, kappa: 0.31138, f1: 0.83899
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.19it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 53.54it/s]
Epoch 17 : Training Loss: 1.05881, acc: 0.26037, kappa: 0.31007, f1: 0.84206, LR: 0.00000, Time elapsed 1.54 mins
[[    0    99     0     0     0    20]
 [    0    12     0     0   279     0]
 [    0   119     0     0   359   191]
 [    0    48     0     0    38     0]
 [    0     1     0     0   311   188]
 [    0   734     0     0   662 12426]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.24it/s]
100%|█████████████████████████████████████████| 242/242 [00:05<00:00, 48.33it/s]
Epoch 18 : Training Loss: 1.01246, acc: 0.26067, kappa: 0.30273, f1: 0.83916, LR: 0.00000, Time elapsed 1.54 mins
[[    0    99     0     0     0    20]
 [    0    12     0     0   279     0]
 [    0   154     0     0   330   185]
 [    0    54     0     0    32     0]
 [    0     5     0     0   316   179]
 [    0   952     0     0   558 12312]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.36it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.74it/s]
Epoch 19 : Training Loss: 0.97551, acc: 0.25775, kappa: 0.27952, f1: 0.82928, LR: 0.00000, Time elapsed 1.52 mins
[[    0    99     0     0     0    20]
 [    0    12     0     0   279     0]
 [    0   149     0     0   330   190]
 [    0    60     0     0    26     0]
 [    0     5     0     0   316   179]
 [    0   989     0     0   763 12070]]
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.11it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.86it/s]
Epoch 20 : Training Loss: 0.95185, acc: 0.27914, kappa: 0.29836, f1: 0.83047, LR: 0.00000, Time elapsed 1.55 mins
[[    0    95     0     0     0    24]
 [    0    12     0     0   279     0]
 [    0   145     0     0   330   194]
 [    0    65     0     0    21     0]
 [    0     5     0     0   382   113]
 [    0   949     0     0   853 12020]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.24it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.56it/s]
Epoch 21 : Training Loss: 0.93663, acc: 0.29273, kappa: 0.30550, f1: 0.82882, LR: 0.00000, Time elapsed 1.53 mins
[[    0    92     0     0     0    27]
 [    0    12     0     0   279     0]
 [    0   145     0     0   330   194]
 [    0    64     0     0    21     1]
 [    0     5     0     0   426    69]
 [    0   912     0     0   980 11930]]
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.15it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.15it/s]
Epoch 22 : Training Loss: 0.92483, acc: 0.29823, kappa: 0.30073, f1: 0.82394, LR: 0.00000, Time elapsed 1.55 mins
[[    0    97     0     0     0    22]
 [    0    12     0     0   279     0]
 [    0   147     0     0   330   192]
 [    0    62     0     0    20     4]
 [    0     7     0     0   448    45]
 [    0   934     0     0  1110 11778]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.25it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.21it/s]
Epoch 23 : Training Loss: 0.91496, acc: 0.29676, kappa: 0.29075, f1: 0.81891, LR: 0.00000, Time elapsed 1.54 mins
[[    0    97     0     0     0    22]
 [    0    12     0     0   279     0]
 [    0   149     0     0   330   190]
 [    0    58     0     0    23     5]
 [    0     8     0     0   448    44]
 [    0   933     0     0  1233 11656]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.22it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.41it/s]
Epoch 24 : Training Loss: 0.90595, acc: 0.29704, kappa: 0.29233, f1: 0.81981, LR: 0.00000, Time elapsed 1.54 mins
[[    0    96     0     0     0    23]
 [    0    12     0     0   279     0]
 [    0   149     0     0   330   190]
 [    0    57     0     0    23     6]
 [    0     7     0     0   448    45]
 [    0   933     0     0  1209 11680]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.25it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.93it/s]
Epoch 25 : Training Loss: 0.89726, acc: 0.29689, kappa: 0.29300, f1: 0.81976, LR: 0.00000, Time elapsed 1.53 mins
[[    0    96     0     0     0    23]
 [    0    12     0     0   279     0]
 [    0   161     0     0   330   178]
 [    0    57     0     0    23     6]
 [    0     8     0     0   448    44]
 [    0   955     0     0  1200 11667]]
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.11it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.76it/s]
Epoch 26 : Training Loss: 0.88830, acc: 0.29756, kappa: 0.29762, f1: 0.82201, LR: 0.00000, Time elapsed 1.55 mins
[[    0    96     0     0     0    23]
 [    0    12     0     0   279     0]
 [    0   162     0     0   330   177]
 [    0    57     0     0    23     6]
 [    0     7     0     0   448    45]
 [    0   933     0     0  1166 11723]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.20it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.91it/s]
Epoch 27 : Training Loss: 0.87802, acc: 0.29776, kappa: 0.29750, f1: 0.82181, LR: 0.00000, Time elapsed 1.54 mins
[[    0    96     0     0     0    23]
 [    0    12     0     0   279     0]
 [    0   170     2     0   330   167]
 [    0    57     0     0    23     6]
 [    0     8     0     0   448    44]
 [    0   998     0     0  1126 11698]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.29it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.49it/s]
Epoch 28 : Training Loss: 0.86784, acc: 0.30778, kappa: 0.30486, f1: 0.82362, LR: 0.00000, Time elapsed 1.53 mins
[[    0    96     0     0     0    23]
 [    0    28     0     0   263     0]
 [    0   187     5     0   330   147]
 [    0    57     0     0    23     6]
 [    0     8     0     0   448    44]
 [    0   998     0     0  1117 11707]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.28it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.00it/s]
Epoch 29 : Training Loss: 0.85598, acc: 0.33227, kappa: 0.31643, f1: 0.82568, LR: 0.00000, Time elapsed 1.53 mins
[[    0    96     0     0     0    23]
 [    0    45     0     0   246     0]
 [    0   186    40     0   317   126]
 [    0    57     0     0    23     6]
 [    0     8     0     0   470    22]
 [    0  1020     0     0  1203 11599]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.33227, kappa: 0.31643, f1: 0.82568
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.28it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.17it/s]
Epoch 30 : Training Loss: 0.84267, acc: 0.33671, kappa: 0.31224, f1: 0.82327, LR: 0.00000, Time elapsed 1.53 mins
[[    0    96     0     0     0    23]
 [    0    45     0     0   246     0]
 [    0   224    66     0   288    91]
 [    0    58     0     0    20     8]
 [    0    10     0     0   470    20]
 [    0  1207     0     0  1185 11430]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.24it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.19it/s]
Epoch 31 : Training Loss: 0.82686, acc: 0.38682, kappa: 0.33958, f1: 0.83067, LR: 0.00000, Time elapsed 1.54 mins
[[    0    96     0     0     0    23]
 [    0   120     0     0   171     0]
 [    0   285    93     0   235    56]
 [    0    62     0     0    14    10]
 [    0    11     0     0   470    19]
 [    0  1234     0     0  1122 11466]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.38682, kappa: 0.33958, f1: 0.83067
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.23it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.01it/s]
Epoch 32 : Training Loss: 0.80933, acc: 0.41990, kappa: 0.31023, f1: 0.80865, LR: 0.00000, Time elapsed 1.54 mins
[[    0    96     0     0     0    23]
 [    0   176     0     0   115     0]
 [    0   434   130     0    97     8]
 [    0    63     2     0    12     9]
 [    0    11     0     0   470    19]
 [    0  1804    58     0  1175 10785]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.35it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.36it/s]
Epoch 33 : Training Loss: 0.79071, acc: 0.42991, kappa: 0.29311, f1: 0.79444, LR: 0.00000, Time elapsed 1.52 mins
[[    0    85    12     0     0    22]
 [    0   191     0     0   100     0]
 [    0   434   153     0    78     4]
 [    0    56     9     0    12     9]
 [    0    12     0     0   470    18]
 [    0  2023   126     0  1246 10427]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.31it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.43it/s]
Epoch 34 : Training Loss: 0.77163, acc: 0.42660, kappa: 0.25903, f1: 0.76592, LR: 0.00000, Time elapsed 1.53 mins
[[   0   69   28    0    0   22]
 [   0  191    0    0  100    0]
 [   0  418  170    0   79    2]
 [   0   53   13    0   13    7]
 [   0   13    0    0  470   17]
 [   0 2401  294    0 1325 9802]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.20it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.27it/s]
Epoch 35 : Training Loss: 0.75712, acc: 0.42839, kappa: 0.22903, f1: 0.73486, LR: 0.00000, Time elapsed 1.54 mins
[[   0   73   28    0    0   18]
 [   0  208    0    0   83    0]
 [   0  427  169    0   71    2]
 [   0   53   15    0   12    6]
 [   0   15    0    0  471   14]
 [   0 2962  380    0 1344 9136]]
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.10it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.50it/s]
Epoch 36 : Training Loss: 0.74510, acc: 0.44140, kappa: 0.20336, f1: 0.69740, LR: 0.00000, Time elapsed 1.55 mins
[[   0   73   28    0    0   18]
 [   0  240    0    0   51    0]
 [   0  456  183    0   28    2]
 [   0   59   15    0   12    0]
 [   0   15    0    0  472   13]
 [   0 3398  576    0 1470 8378]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.16it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.56it/s]
Epoch 37 : Training Loss: 0.73471, acc: 0.44389, kappa: 0.21147, f1: 0.70826, LR: 0.00000, Time elapsed 1.54 mins
[[   0   69   28    0    0   22]
 [   0  240    0    0   51    0]
 [   0  454  183    0   30    2]
 [   0   63   11    0   12    0]
 [   0   15    0    0  472   13]
 [   0 3226  454   22 1536 8584]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.18it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.86it/s]
Epoch 38 : Training Loss: 0.72553, acc: 0.45328, kappa: 0.21352, f1: 0.70826, LR: 0.00000, Time elapsed 1.54 mins
[[   0   71   28    0    0   20]
 [   0  256    0    0   35    0]
 [   0  453  189    0   25    2]
 [   0   63   11    0   12    0]
 [   0   17    0    1  469   13]
 [   0 3270  432   96 1462 8562]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.22it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 48.90it/s]
Epoch 39 : Training Loss: 0.71624, acc: 0.44575, kappa: 0.21241, f1: 0.70812, LR: 0.00000, Time elapsed 1.54 mins
[[   0   71   28    0    0   20]
 [   0  240    0    0   51    0]
 [   0  444  191    0   34    0]
 [   0   63   11    0   12    0]
 [   0   15    0    0  472   13]
 [   0 3152  454   66 1577 8573]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.33it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.00it/s]
Epoch 40 : Training Loss: 0.70633, acc: 0.45251, kappa: 0.23201, f1: 0.73003, LR: 0.00000, Time elapsed 1.53 mins
[[   0   70   28    0    0   21]
 [   0  240    0    0   51    0]
 [   0  438  197    0   34    0]
 [   0   67    7    0   12    0]
 [   0   15    0    0  472   13]
 [   0 2678  399   88 1647 9010]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.31it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.29it/s]
Epoch 41 : Training Loss: 0.69755, acc: 0.45690, kappa: 0.24676, f1: 0.74563, LR: 0.00000, Time elapsed 1.53 mins
[[   0   68   28    0    0   23]
 [   0  240    0    0   51    0]
 [   0  442  200    0   27    0]
 [   0   69    5    0   12    0]
 [   0   14    0    0  472   14]
 [   0 2415  290  154 1651 9312]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.26it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.92it/s]
Epoch 42 : Training Loss: 0.68848, acc: 0.45833, kappa: 0.25097, f1: 0.74943, LR: 0.00000, Time elapsed 1.53 mins
[[   0   68   28    0    0   23]
 [   0  240    0    0   51    0]
 [   0  433  202    0   34    0]
 [   0   69    5    0   12    0]
 [   0   15    0    0  472   13]
 [   0 2360  290  154 1629 9389]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.36it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.08it/s]
Epoch 43 : Training Loss: 0.67966, acc: 0.46922, kappa: 0.26234, f1: 0.75840, LR: 0.00000, Time elapsed 1.53 mins
[[   0   68   28    0    0   23]
 [   0  256    0    0   35    0]
 [   0  442  202    0   25    0]
 [   0   69    5    0   12    0]
 [   0   15    0    1  471   13]
 [   0 2250  268  249 1495 9560]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.22it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.90it/s]
Epoch 44 : Training Loss: 0.67012, acc: 0.47618, kappa: 0.28932, f1: 0.77992, LR: 0.00000, Time elapsed 1.54 mins
[[    0    68    28     0     0    23]
 [    0   256     0     0    35     0]
 [    0   437   207     0    25     0]
 [    0    70     4     0    12     0]
 [    0    13     0     1   471    15]
 [    0  1762   268   227  1531 10034]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.21it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.97it/s]
Epoch 45 : Training Loss: 0.66106, acc: 0.48160, kappa: 0.34786, f1: 0.82039, LR: 0.00000, Time elapsed 1.54 mins
[[    0    68    28     0     0    23]
 [    0   240     0     0    51     0]
 [    0   436   208     0    25     0]
 [    0    68     4     2    12     0]
 [    0    10     0     1   470    19]
 [    0  1234   168   205  1286 10929]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.48160, kappa: 0.34786, f1: 0.82039
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.25it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.97it/s]
Epoch 46 : Training Loss: 0.65389, acc: 0.47996, kappa: 0.33955, f1: 0.81496, LR: 0.00000, Time elapsed 1.54 mins
[[    0    68    28     0     0    23]
 [    0   240     0     0    51     0]
 [    0   427   205     0    37     0]
 [    0    70     2     2    12     0]
 [    0    11     0     0   471    18]
 [    0  1194   212   197  1392 10827]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.25it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.48it/s]
Epoch 47 : Training Loss: 0.64567, acc: 0.46401, kappa: 0.34523, f1: 0.82050, LR: 0.00000, Time elapsed 1.54 mins
[[    0    68    28     0     0    23]
 [    0   209     0     0    82     0]
 [    0   413   205     0    51     0]
 [    0    69     2     2    13     0]
 [    0    10     0     0   471    19]
 [    0   951   212   241  1441 10977]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.22it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.84it/s]
Epoch 48 : Training Loss: 0.63776, acc: 0.47376, kappa: 0.35912, f1: 0.82811, LR: 0.00000, Time elapsed 1.54 mins
[[    0    68    28     0     0    23]
 [    0   209     0     0    82     0]
 [    0   405   205     0    59     0]
 [    0    69     2     6     9     0]
 [    0     8     0     0   471    21]
 [    0   912   178   219  1370 11143]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47376, kappa: 0.35912, f1: 0.82811
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.17it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.84it/s]
Epoch 49 : Training Loss: 0.63209, acc: 0.47654, kappa: 0.35848, f1: 0.82750, LR: 0.00000, Time elapsed 1.54 mins
[[    0    68    28     0     0    23]
 [    0   209     0     0    82     0]
 [    0   378   202     0    89     0]
 [    0    67     2     8     9     0]
 [    0     9     0     0   470    21]
 [    0   884   200   219  1378 11141]]
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.14it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.10it/s]
Epoch 50 : Training Loss: 0.62472, acc: 0.47031, kappa: 0.36338, f1: 0.83014, LR: 0.00000, Time elapsed 1.55 mins
[[    0    68    28     0     0    23]
 [    0   209     0     0    82     0]
 [    0   349   205     0   115     0]
 [    0    67     2     4    13     0]
 [    0     7     0     0   470    23]
 [    0   863   200   197  1356 11206]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47031, kappa: 0.36338, f1: 0.83014
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.15it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.55it/s]
Epoch 51 : Training Loss: 0.61728, acc: 0.47865, kappa: 0.35985, f1: 0.82745, LR: 0.00000, Time elapsed 1.55 mins
[[    0    62    34     0     0    23]
 [    0   209     0     0    82     0]
 [    0   307   209     0   153     0]
 [    0    63     2     8    13     0]
 [    0     7     0     0   471    22]
 [    0   841   232   219  1386 11144]]
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.15it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.18it/s]
Epoch 52 : Training Loss: 0.61222, acc: 0.45971, kappa: 0.37360, f1: 0.83698, LR: 0.00000, Time elapsed 1.55 mins
[[    0    62    34     0     0    23]
 [    0   177     0     0   114     0]
 [    0   280   213     0   176     0]
 [    0    58     2     6    16     4]
 [    0     6     0     0   469    25]
 [    0   756   210   153  1316 11387]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45971, kappa: 0.37360, f1: 0.83698
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.23it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.32it/s]
Epoch 53 : Training Loss: 0.60678, acc: 0.46408, kappa: 0.35385, f1: 0.82698, LR: 0.00000, Time elapsed 1.54 mins
[[    0    72    24     0     0    23]
 [    0   177     0     0   114     0]
 [    0   281   210     0   178     0]
 [    0    60     0    10    16     0]
 [    0     6     0     0   470    24]
 [    0   792   210   263  1416 11141]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.23it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.83it/s]
Epoch 54 : Training Loss: 0.60103, acc: 0.45953, kappa: 0.38103, f1: 0.84231, LR: 0.00000, Time elapsed 1.54 mins
[[    0    72    24     0     0    23]
 [    0   155     0     0   136     0]
 [    0   232   216     0   203    18]
 [    0    50     2    11    16     7]
 [    0     5     0     0   470    25]
 [    0   603   176   153  1366 11524]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45953, kappa: 0.38103, f1: 0.84231
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.25it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.95it/s]
Epoch 55 : Training Loss: 0.59693, acc: 0.44612, kappa: 0.36837, f1: 0.83852, LR: 0.00000, Time elapsed 1.54 mins
[[    0    72    24     0     0    23]
 [    0   122     0     0   169     0]
 [    0   233   211     0   216     9]
 [    0    52     0    15    16     3]
 [    0     6     0     0   470    24]
 [    0   691   154   175  1362 11440]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.28it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 53.01it/s]
Epoch 56 : Training Loss: 0.59196, acc: 0.46979, kappa: 0.38567, f1: 0.84616, LR: 0.00000, Time elapsed 1.53 mins
[[    0    71    25     0     0    23]
 [    0   122     0     0   169     0]
 [    0   207   213     0   231    18]
 [    0    49     0    26     5     6]
 [    0     5     0     0   469    26]
 [    0   603   154   131  1313 11621]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.46979, kappa: 0.38567, f1: 0.84616
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.21it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.76it/s]
Epoch 57 : Training Loss: 0.58826, acc: 0.45842, kappa: 0.37139, f1: 0.83927, LR: 0.00000, Time elapsed 1.54 mins
[[    0    59    37     0     0    23]
 [    0   122     0     0   169     0]
 [    0   203   213     0   251     2]
 [    0    49     0    21    11     5]
 [    0     5     0     0   470    25]
 [    0   641   154   153  1420 11454]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.30it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.24it/s]
Epoch 58 : Training Loss: 0.58470, acc: 0.47595, kappa: 0.38669, f1: 0.84618, LR: 0.00000, Time elapsed 1.53 mins
[[    0    59    37     0     0    23]
 [    0   122     0     0   169     0]
 [    0   194   213     0   244    18]
 [    0    47     0    29     5     5]
 [    0     3     2     0   470    25]
 [    0   577   152   131  1340 11622]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47595, kappa: 0.38669, f1: 0.84618
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.04it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.98it/s]
Epoch 59 : Training Loss: 0.58182, acc: 0.47420, kappa: 0.37030, f1: 0.83855, LR: 0.00000, Time elapsed 1.56 mins
[[    0    59    37     0     0    23]
 [    0   122     0     0   169     0]
 [    0   195   215     0   243    16]
 [    0    47     0    29     5     5]
 [    0     5     0     0   470    25]
 [    0   625   154   175  1432 11436]]
100%|███████████████████████████████████████| 1070/1070 [07:09<00:00,  2.49it/s]
100%|█████████████████████████████████████████| 242/242 [02:02<00:00,  1.98it/s]
Epoch 60 : Training Loss: 0.57832, acc: 0.46675, kappa: 0.38441, f1: 0.84682, LR: 0.00000, Time elapsed 9.20 mins
[[    0    68    28     0     0    23]
 [    0   102     0     0   189     0]
 [    0   193   215     0   245    16]
 [    0    47     0    30     4     5]
 [    0     5     0     0   469    26]
 [    0   619   132   109  1327 11635]]
100%|███████████████████████████████████████| 1070/1070 [03:34<00:00,  4.99it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.67it/s]
Epoch 61 : Training Loss: 0.57455, acc: 0.45206, kappa: 0.38330, f1: 0.84761, LR: 0.00000, Time elapsed 3.65 mins
[[    0    68    28     0     0    23]
 [    0   102     0     0   189     0]
 [    0   181   209     0   259    20]
 [    0    45     0    23     4    14]
 [    0     5     0     0   469    26]
 [    0   624    88    92  1352 11666]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.34it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.01it/s]
Epoch 62 : Training Loss: 0.57175, acc: 0.45665, kappa: 0.37262, f1: 0.84257, LR: 0.00000, Time elapsed 1.53 mins
[[    0    59    37     0     0    23]
 [    0    87     0     0   204     0]
 [    0   142   213     0   296    18]
 [    0    46     0    30     4     6]
 [    0     4     0     0   469    27]
 [    0   598   110   131  1432 11551]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.16it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.51it/s]
Epoch 63 : Training Loss: 0.56920, acc: 0.45647, kappa: 0.37162, f1: 0.84165, LR: 0.00000, Time elapsed 1.55 mins
[[    0    59    37     0     0    23]
 [    0    87     0     0   204     0]
 [    0   137   213     0   303    16]
 [    0    45     0    30     8     3]
 [    0     2     1     0   469    28]
 [    0   549   131   153  1453 11536]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.17it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.06it/s]
Epoch 64 : Training Loss: 0.56681, acc: 0.46491, kappa: 0.37365, f1: 0.84173, LR: 0.00000, Time elapsed 1.54 mins
[[    0    59    37     0     0    23]
 [    0   102     0     0   189     0]
 [    0   151   213     0   289    16]
 [    0    45     0    30     8     3]
 [    0     4     0     0   469    27]
 [    0   575   132   136  1455 11524]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.21it/s]
100%|█████████████████████████████████████████| 242/242 [00:05<00:00, 48.40it/s]
Epoch 65 : Training Loss: 0.56325, acc: 0.46047, kappa: 0.38263, f1: 0.84613, LR: 0.00000, Time elapsed 1.54 mins
[[    0    59    37     0     0    23]
 [    0   102     0     0   189     0]
 [    0   151   213     0   287    18]
 [    0    43     0    27     8     8]
 [    0     3     0     0   469    28]
 [    0   511   132   109  1432 11638]]
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.14it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.63it/s]
Epoch 66 : Training Loss: 0.56051, acc: 0.45557, kappa: 0.37893, f1: 0.84486, LR: 0.00000, Time elapsed 1.55 mins
[[    0    59    37     0     0    23]
 [    0    87     0     0   204     0]
 [    0   137   213     0   303    16]
 [    0    43     0    29     8     6]
 [    0     3     0     0   469    28]
 [    0   532   154   126  1388 11622]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.25it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.13it/s]
Epoch 67 : Training Loss: 0.55792, acc: 0.46497, kappa: 0.38129, f1: 0.84579, LR: 0.00000, Time elapsed 1.53 mins
[[    0    59    37     0     0    23]
 [    0    87     0     0   204     0]
 [    0   137   211     0   303    18]
 [    0    41     0    34     8     3]
 [    0     3     0     0   469    28]
 [    0   532   154   104  1392 11640]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.28it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.77it/s]
Epoch 68 : Training Loss: 0.55472, acc: 0.46570, kappa: 0.38687, f1: 0.84807, LR: 0.00000, Time elapsed 1.53 mins
[[    0    59    37     0     0    23]
 [    0    87     0     0   204     0]
 [    0   134   211     0   306    18]
 [    0    41     0    34     8     3]
 [    0     2     1     0   469    28]
 [    0   490   175    82  1375 11700]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.46570, kappa: 0.38687, f1: 0.84807
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.10it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.11it/s]
Epoch 69 : Training Loss: 0.55368, acc: 0.46653, kappa: 0.39279, f1: 0.85098, LR: 0.00000, Time elapsed 1.55 mins
[[    0    59    37     0     0    23]
 [    0    87     0     0   204     0]
 [    0   134   211     0   306    18]
 [    0    37     0    34     6     9]
 [    0     2     0     0   469    29]
 [    0   468   166    60  1359 11769]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.46653, kappa: 0.39279, f1: 0.85098
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.28it/s]
100%|█████████████████████████████████████████| 242/242 [00:05<00:00, 48.34it/s]
Epoch 70 : Training Loss: 0.55145, acc: 0.47590, kappa: 0.38768, f1: 0.84740, LR: 0.00000, Time elapsed 1.54 mins
[[    0    59    37     0     0    23]
 [    0   102     0     0   189     0]
 [    0   142   211     0   298    18]
 [    0    38     0    35    10     3]
 [    0     2     0     0   469    29]
 [    0   490   166   143  1350 11673]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.24it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.62it/s]
Epoch 71 : Training Loss: 0.54921, acc: 0.47045, kappa: 0.38552, f1: 0.84871, LR: 0.00000, Time elapsed 1.53 mins
[[    0    59    37     0     0    23]
 [    0   102     0     0   189     0]
 [    0   134   208     0   306    21]
 [    0    37     0    36    10     3]
 [    0     2     0     0   447    51]
 [    0   490   144   121  1337 11730]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.28it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 53.37it/s]
Epoch 72 : Training Loss: 0.54568, acc: 0.47144, kappa: 0.38797, f1: 0.84957, LR: 0.00000, Time elapsed 1.53 mins
[[    0    59    37     0     0    23]
 [    0   102     0     0   189     0]
 [    0   134   211     0   306    18]
 [    0    37     0    36     6     7]
 [    0     2     0     0   447    51]
 [    0   490   156   121  1305 11750]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.25it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.69it/s]
Epoch 73 : Training Loss: 0.54439, acc: 0.47561, kappa: 0.37417, f1: 0.84127, LR: 0.00000, Time elapsed 1.54 mins
[[    0    59    37     0     0    23]
 [    0   102     0     0   189     0]
 [    0   136   209     0   313    11]
 [    0    37     0    36     6     7]
 [    0     2     0     0   469    29]
 [    0   505   178   127  1483 11529]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.16it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.47it/s]
Epoch 74 : Training Loss: 0.54171, acc: 0.47453, kappa: 0.38652, f1: 0.84903, LR: 0.00000, Time elapsed 1.55 mins
[[    0    59    37     0     0    23]
 [    0   102     0     0   189     0]
 [    0   123   208     0   313    25]
 [    0    35     0    38     6     7]
 [    0     2     0     0   447    51]
 [    0   484   178    83  1330 11747]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.24it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.18it/s]
Epoch 75 : Training Loss: 0.53946, acc: 0.47652, kappa: 0.39693, f1: 0.85372, LR: 0.00000, Time elapsed 1.54 mins
[[    0    59    37     0     0    23]
 [    0   102     0     0   189     0]
 [    0   142   203     0   303    21]
 [    0    35     0    39     4     8]
 [    0     2     0     0   447    51]
 [    0   490   144    81  1252 11855]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47652, kappa: 0.39693, f1: 0.85372
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.20it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 48.77it/s]
Epoch 76 : Training Loss: 0.53714, acc: 0.46926, kappa: 0.37958, f1: 0.84535, LR: 0.00000, Time elapsed 1.54 mins
[[    0    54    37     0     0    28]
 [    0   102     0     0   189     0]
 [    0   142   206     0   310    11]
 [    0    39     0    36     4     7]
 [    0     2     0     0   447    51]
 [    0   474   222   121  1332 11673]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.19it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.28it/s]
Epoch 77 : Training Loss: 0.53496, acc: 0.48410, kappa: 0.38923, f1: 0.84798, LR: 0.00000, Time elapsed 1.54 mins
[[    0    54    37     0     0    28]
 [    0   102     0     0   189     0]
 [    0   156   204     0   298    11]
 [    0    37     0    40     4     5]
 [    0     2     0     0   469    29]
 [    0   496   178   109  1345 11694]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.25it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.30it/s]
Epoch 78 : Training Loss: 0.53407, acc: 0.50729, kappa: 0.41269, f1: 0.85771, LR: 0.00000, Time elapsed 1.53 mins
[[    0    38    53     0     0    28]
 [    0   122     0     0   169     0]
 [    0   139   206     0   299    25]
 [    0    33     0    48     0     5]
 [    0     2     0     0   447    51]
 [    0   424   210    96  1144 11948]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.50729, kappa: 0.41269, f1: 0.85771
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.17it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.13it/s]
Epoch 79 : Training Loss: 0.53122, acc: 0.49091, kappa: 0.38630, f1: 0.84833, LR: 0.00000, Time elapsed 1.55 mins
[[    0    54    37     0     0    28]
 [    0   102     0     0   189     0]
 [    0   139   205     0   314    11]
 [    0    30     0    47     4     5]
 [    0     2     0     0   447    51]
 [    0   462   210    59  1370 11721]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.18it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 48.44it/s]
Epoch 80 : Training Loss: 0.52948, acc: 0.48996, kappa: 0.39652, f1: 0.85299, LR: 0.00000, Time elapsed 1.55 mins
[[    0    54    37     0     0    28]
 [    0   102     0     0   189     0]
 [    0   128   203     0   313    25]
 [    0    31     0    46     4     5]
 [    0     2     0     0   447    51]
 [    0   490   188    70  1230 11844]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.25it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.90it/s]
Epoch 81 : Training Loss: 0.52768, acc: 0.50031, kappa: 0.38199, f1: 0.84527, LR: 0.00000, Time elapsed 1.53 mins
[[    0    38    53     0     0    28]
 [    0   122     0     0   169     0]
 [    0   157   200    17   274    21]
 [    0    34     0    47     0     5]
 [    0     2     0     0   447    51]
 [   22   446   210    75  1415 11654]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.20it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.01it/s]
Epoch 82 : Training Loss: 0.52620, acc: 0.51090, kappa: 0.40760, f1: 0.85610, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   122     0     0   169     0]
 [    0   128   199    16   300    26]
 [    0    30     0    51     0     5]
 [    0     1     0     0   447    52]
 [    0   424   176    75  1237 11910]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.19it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.08it/s]
Epoch 83 : Training Loss: 0.52340, acc: 0.50100, kappa: 0.41176, f1: 0.85901, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   102     0     0   189     0]
 [    0   139   202    17   290    21]
 [    0    30     0    51     0     5]
 [    0     2     0     0   447    51]
 [   22   446   154    53  1170 11977]]
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.15it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.70it/s]
Epoch 84 : Training Loss: 0.52163, acc: 0.50966, kappa: 0.40480, f1: 0.85494, LR: 0.00000, Time elapsed 1.55 mins
[[    0    38    53     0     0    28]
 [    0   122     0     0   169     0]
 [    0   198   195    21   229    26]
 [    0    30     0    51     0     5]
 [    0     1     0     0   447    52]
 [    0   424   176    80  1252 11890]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.27it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.14it/s]
Epoch 85 : Training Loss: 0.52033, acc: 0.51276, kappa: 0.39094, f1: 0.84921, LR: 0.00000, Time elapsed 1.53 mins
[[    0    38    53     0     0    28]
 [    0   122     0     0   169     0]
 [    0   130   199    17   297    26]
 [    0    28     0    53     0     5]
 [    0     1     0     0   447    52]
 [    0   418   182    75  1404 11743]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.16it/s]
100%|█████████████████████████████████████████| 242/242 [00:05<00:00, 47.47it/s]
Epoch 86 : Training Loss: 0.51924, acc: 0.51580, kappa: 0.42782, f1: 0.86426, LR: 0.00000, Time elapsed 1.55 mins
[[    0    38    53     0     0    28]
 [    0   122     0     0   169     0]
 [    0   170   195    17   257    30]
 [    0    28     0    53     0     5]
 [    0     1     0     0   446    53]
 [   22   424   154    59  1058 12105]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.51580, kappa: 0.42782, f1: 0.86426
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.24it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.42it/s]
Epoch 87 : Training Loss: 0.51707, acc: 0.51510, kappa: 0.41012, f1: 0.85732, LR: 0.00000, Time elapsed 1.53 mins
[[    0    38    53     0     0    28]
 [    0   122     0     0   169     0]
 [    0   190   201    17   239    22]
 [    0    28     0    53     0     5]
 [    0     1     0     0   446    53]
 [   23   424   154    64  1234 11923]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.21it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.02it/s]
Epoch 88 : Training Loss: 0.51543, acc: 0.51261, kappa: 0.39926, f1: 0.85317, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   122     0     0   169     0]
 [    0   170   196    17   272    14]
 [    0    28     0    53     0     5]
 [    0     1     0     0   446    53]
 [   22   446   132    64  1338 11820]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.22it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.18it/s]
Epoch 89 : Training Loss: 0.51416, acc: 0.51377, kappa: 0.41549, f1: 0.85959, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   122     0     0   169     0]
 [    0   174   192    21   251    31]
 [    0    28     0    53     0     5]
 [    0     1     0     0   446    53]
 [   67   380   154    90  1132 11999]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.16it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.62it/s]
Epoch 90 : Training Loss: 0.51220, acc: 0.51827, kappa: 0.40831, f1: 0.85551, LR: 0.00000, Time elapsed 1.55 mins
[[    0    38    53     0     0    28]
 [    0   122     0     0   169     0]
 [    0   195   216    40   196    22]
 [    0    28     0    53     0     5]
 [    0     1     0     0   446    53]
 [    1   446   220    59  1220 11876]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.22it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.08it/s]
Epoch 91 : Training Loss: 0.51109, acc: 0.52147, kappa: 0.41125, f1: 0.85730, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   140     0     0   151     0]
 [    0   201   184    44   200    40]
 [    0    28     0    53     0     5]
 [    0     1     0     0   446    53]
 [   66   380   154    64  1210 11948]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.19it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 53.36it/s]
Epoch 92 : Training Loss: 0.51027, acc: 0.52581, kappa: 0.38799, f1: 0.84653, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   140     0     0   151     0]
 [    0   186   215    40   200    28]
 [    0    28     0    53     0     5]
 [    1     1     0     0   447    51]
 [   23   418   182    69  1490 11640]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.27it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.79it/s]
Epoch 93 : Training Loss: 0.50828, acc: 0.52767, kappa: 0.42507, f1: 0.86203, LR: 0.00000, Time elapsed 1.53 mins
[[    0    38    53     0     0    28]
 [    0   140     0     0   151     0]
 [    0   214   205    44   172    34]
 [    0    28     0    53     0     5]
 [    0     1     0     0   446    53]
 [   44   380   176    54  1140 12028]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.26it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.45it/s]
Epoch 94 : Training Loss: 0.50736, acc: 0.52657, kappa: 0.41116, f1: 0.85706, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   140     0     0   151     0]
 [    0   232   199    20   191    27]
 [    0    28     0    54     0     4]
 [    1     1     0     0   446    52]
 [   68   380   154    54  1266 11900]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.17it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.17it/s]
Epoch 95 : Training Loss: 0.50550, acc: 0.52685, kappa: 0.39104, f1: 0.84785, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   140     0     0   151     0]
 [    0   208   211    20   206    24]
 [    0    28     0    54     0     4]
 [    1     1     0     0   446    52]
 [   89   374   226    64  1394 11675]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.18it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 51.05it/s]
Epoch 96 : Training Loss: 0.50492, acc: 0.53331, kappa: 0.41593, f1: 0.85855, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   140     0     0   151     0]
 [    0   214   201    44   181    29]
 [    0    25     0    57     0     4]
 [    1     1     0     0   446    52]
 [   45   446   154    49  1192 11936]]
100%|███████████████████████████████████████| 1070/1070 [01:26<00:00, 12.31it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 49.58it/s]
Epoch 97 : Training Loss: 0.50336, acc: 0.52776, kappa: 0.41349, f1: 0.85778, LR: 0.00000, Time elapsed 1.53 mins
[[    0    38    53     0     0    28]
 [    0   140     0     0   151     0]
 [    0   228   203    30   179    29]
 [    0    28     0    54     0     4]
 [    1     1     0     0   446    52]
 [   46   402   154    54  1250 11916]]
100%|███████████████████████████████████████| 1070/1070 [01:28<00:00, 12.10it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.96it/s]
Epoch 98 : Training Loss: 0.50238, acc: 0.54193, kappa: 0.39631, f1: 0.85109, LR: 0.00000, Time elapsed 1.55 mins
[[    0    38    53     0     0    28]
 [    0   140     0     0   151     0]
 [    0   193   198    20   224    34]
 [    0    18     0    63     0     5]
 [    1     1     0     0   446    52]
 [   68   380   132    54  1440 11748]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.20it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 52.56it/s]
Epoch 99 : Training Loss: 0.50136, acc: 0.53898, kappa: 0.39379, f1: 0.84873, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   140     0     0   151     0]
 [    0   221   212    26   180    30]
 [    0    22     0    60     0     4]
 [    1     1     0     0   446    52]
 [   46   374   226    54  1426 11696]]
100%|███████████████████████████████████████| 1070/1070 [01:27<00:00, 12.19it/s]
100%|█████████████████████████████████████████| 242/242 [00:04<00:00, 50.28it/s]
Epoch 100 : Training Loss: 0.50032, acc: 0.54286, kappa: 0.42372, f1: 0.86140, LR: 0.00000, Time elapsed 1.54 mins
[[    0    38    53     0     0    28]
 [    0   140     0     0   151     0]
 [    0   207   202    43   183    34]
 [    0    19     0    63     0     4]
 [    1     1    10     0   436    52]
 [   46   374   176    80  1127 12019]]
***************************Test************************
100%|█████████████████████████████████████████| 460/460 [01:21<00:00,  5.64it/s]
***************************Test results************************
Test Evaluation: acc: 0.63446, kappa: 0.58864, f1: 0.78253
[[   64   318   125     8    11    41]
 [    0  3145   328     0  1115    89]
 [   73   391  1317     6    67   144]
 [    0     0     0   276    26    27]
 [    1    41    35    16  1544   567]
 [   12   529   746    78  2116 16165]]
model save in /media/public/eshuranov/cbramod/models_weights/tuev_23_model/epoch86_acc_0.63446_kappa_0.58864_f1_0.78253.pth
Done!!!!!

Process finished with exit code 0
